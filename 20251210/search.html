<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arti-fy - ê²€ìƒ‰</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kranky&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
            background: #FAFAFA;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo {
            font-family: 'Kranky', cursive;
            font-size: 28px;
            color: #000;
        }

        .header-icons {
            display: flex;
            gap: 15px;
            font-size: 20px;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            padding: 5px;
        }

        /* Search Bar */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #E0E0E0;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
        }

        .search-input:focus {
            border-color: #666;
        }

        .search-btn {
            padding: 12px 20px;
            background: #333;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 8px 18px;
            background: #F5F5F5;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            white-space: nowrap;
            color: #666;
            transition: all 0.2s;
        }

        .tab.active {
            background: #333;
            color: white;
        }

        /* Location */
        .location-bar {
            padding: 15px 20px;
            background: #F8F8F8;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #666;
        }

        .region-select {
            padding: 8px 12px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            outline: none;
            font-weight: 500;
        }

        .region-select:focus {
            border-color: #333;
        }

        /* Performance List */
        .performance-list {
            padding: 20px;
        }

        .performance-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .performance-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .poster {
            width: 90px;
            height: 120px;
            background: #E0E0E0;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .poster.loading {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 12px;
        }

        .info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .genre-badge {
            display: inline-block;
            padding: 4px 10px;
            background: #333;
            color: white;
            border-radius: 12px;
            font-size: 11px;
            width: fit-content;
        }

        .title {
            font-size: 16px;
            font-weight: 600;
            color: #000;
            line-height: 1.3;
        }

        .period, .venue {
            font-size: 13px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .state-badge {
            display: inline-block;
            padding: 3px 8px;
            background: #4CAF50;
            color: white;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 500;
        }

        .state-badge.ended {
            background: #999;
        }

        .state-badge.upcoming {
            background: #2196F3;
        }

        /* Loading */
        .loading-spinner {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #333;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        /* API Key Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #000;
        }

        .modal-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 20px;
            outline: none;
        }

        .modal-input:focus {
            border-color: #333;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            font-weight: 500;
        }

        .modal-btn.primary {
            background: #333;
            color: white;
        }

        .modal-btn.secondary {
            background: #F5F5F5;
            color: #666;
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            background: white;
            border-top: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-around;
            padding: 12px 0 8px;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.04);
        }

        .nav-item {
            text-align: center;
            cursor: pointer;
            flex: 1;
            padding: 5px;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 11px;
            color: #999;
            font-weight: 500;
        }

        .nav-item.active .nav-label {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div class="logo">Arti-fy</div>
                <div class="header-icons">
                    <button class="icon-btn" onclick="openApiModal()">âš™ï¸</button>
                    <button class="icon-btn" onclick="location.href='mypage.html'">ğŸ‘¤</button>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="search-bar">
                <input type="text" class="search-input" id="searchInput" placeholder="ê³µì—°, ì „ì‹œ, ì¥ì†Œë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”">
                <button class="search-btn" onclick="searchPerformances()">ê²€ìƒ‰</button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="filterByGenre('all')">ì „ì²´</button>
                <button class="tab" onclick="filterByGenre('AAAA')">ì—°ê·¹</button>
                <button class="tab" onclick="filterByGenre('GGGA')">ë®¤ì§€ì»¬</button>
                <button class="tab" onclick="filterByGenre('CCCA')">ì½˜ì„œíŠ¸</button>
                <button class="tab" onclick="filterByGenre('EEEB')">í´ë˜ì‹</button>
            </div>
        </div>

        <!-- Location Bar -->
        <div class="location-bar">
            ğŸ“ 
            <select class="region-select" id="regionSelect" onchange="changeRegion()">
                <option value="11">ì„œìš¸</option>
                <option value="26">ë¶€ì‚°</option>
                <option value="27">ëŒ€êµ¬</option>
                <option value="28">ì¸ì²œ</option>
                <option value="29">ê´‘ì£¼</option>
                <option value="30">ëŒ€ì „</option>
                <option value="31">ìš¸ì‚°</option>
                <option value="36">ì„¸ì¢…</option>
                <option value="41">ê²½ê¸°</option>
                <option value="42">ê°•ì›</option>
                <option value="43">ì¶©ë¶</option>
                <option value="44">ì¶©ë‚¨</option>
                <option value="45">ì „ë¶</option>
                <option value="46">ì „ë‚¨</option>
                <option value="47">ê²½ë¶</option>
                <option value="48">ê²½ë‚¨</option>
                <option value="50">ì œì£¼</option>
            </select>
            <span id="locationText">ì§€ì—­ ê³µì—°</span>
        </div>

        <!-- Performance List -->
        <div class="performance-list" id="performanceList">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <div>ê³µì—° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-item" onclick="location.href='home.html'">
            <div class="nav-icon">ğŸ </div>
            <div class="nav-label">í™ˆ</div>
        </div>
        <div class="nav-item active">
            <div class="nav-icon">ğŸ”</div>
            <div class="nav-label">ê²€ìƒ‰</div>
        </div>
        <div class="nav-item" onclick="location.href='mypage.html'">
            <div class="nav-icon">ğŸ‘¤</div>
            <div class="nav-label">ë§ˆì´</div>
        </div>
    </div>

    <!-- API Key Modal -->
    <div class="modal" id="apiModal">
        <div class="modal-content">
            <div class="modal-title">KOPIS API í‚¤ ì„¤ì •</div>
            <input type="text" class="modal-input" id="apiKeyInput" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeApiModal()">ì·¨ì†Œ</button>
                <button class="modal-btn primary" onclick="saveApiKey()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        let currentGenre = 'all';
        let currentRegion = '11'; // ê¸°ë³¸ê°’: ì„œìš¸
        let allPerformances = [];

        // ë¡œê·¸ì¸ ì²´í¬
        function checkLogin() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (!isLoggedIn) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = 'index.html';
            }
        }

        // API í‚¤ ê´€ë¦¬
        function openApiModal() {
            const modal = document.getElementById('apiModal');
            const input = document.getElementById('apiKeyInput');
            input.value = localStorage.getItem('kopisApiKey') || '';
            modal.classList.add('show');
        }

        function closeApiModal() {
            document.getElementById('apiModal').classList.remove('show');
        }

        function saveApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            localStorage.setItem('kopisApiKey', apiKey);
            alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            closeApiModal();
            loadPerformances();
        }

        // KOPIS API í˜¸ì¶œ (ì‹¤ì œ API ì‚¬ìš©)
        async function loadPerformances() {
            const apiKey = localStorage.getItem('kopisApiKey');
            
            if (!apiKey) {
                showEmptyState('âš™ï¸ API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.<br>ìš°ì¸¡ ìƒë‹¨ ì„¤ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
                return;
            }

            showLoading();

            try {
                // ë‚ ì§œ ì„¤ì • (ì˜¤ëŠ˜ë¶€í„° 30ì¼)
                const today = new Date();
                const stdate = formatDate(today);
                const eddate = formatDate(new Date(today.getTime() + 30*24*60*60*1000));
                
                // í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•´ API í˜¸ì¶œ (ì„ íƒëœ ì§€ì—­ ì‚¬ìš©)
                const proxyUrl = 'http://localhost:3000/api/performances';
                const url = `${proxyUrl}?apiKey=${apiKey}&stdate=${stdate}&eddate=${eddate}&cpage=1&rows=50&sharea=${currentRegion}`;
                
                console.log('API í˜¸ì¶œ ì‹œì‘... (ì§€ì—­ì½”ë“œ:', currentRegion, ')');
                
                const response = await fetch(url);
                const data = await response.json();
                
                console.log('API ì‘ë‹µ:', data);
                
                if (!response.ok || !data.success) {
                    throw new Error(data.message || 'API í˜¸ì¶œ ì‹¤íŒ¨');
                }
                
                // ê³µì—° ë°ì´í„° ë³€í™˜
                allPerformances = data.performances.map(perf => ({
                    mt20id: perf.mt20id,
                    prfnm: perf.prfnm,
                    prfpdfrom: perf.prfpdfrom,
                    prfpdto: perf.prfpdto,
                    fcltynm: perf.fcltynm,
                    poster: perf.poster || 'https://via.placeholder.com/200x280/CCCCCC/666666?text=No+Image',
                    genrenm: perf.genrenm,
                    prfstate: perf.prfstate,
                    area: perf.area || getRegionName(currentRegion)
                }));
                
                console.log(`API ì‘ë‹µ: ${allPerformances.length}ê°œ ê³µì—°`);
                
                // í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì§€ì—­ í•„í„°ë§ (APIê°€ ì§€ì—­ í•„í„°ë¥¼ ì œëŒ€ë¡œ ì•ˆ í•  ê²½ìš° ëŒ€ë¹„)
                const filteredPerformances = allPerformances.filter(perf => 
                    matchRegion(perf.area, currentRegion)
                );
                
                console.log(`${getRegionName(currentRegion)} í•„í„°ë§ ê²°ê³¼: ${filteredPerformances.length}ê°œ ê³µì—°`);
                
                // í•„í„°ë§ëœ ë°ì´í„°ë¥¼ allPerformancesì— ì €ì¥
                allPerformances = filteredPerformances;
                
                if (allPerformances.length === 0) {
                    showEmptyState(`ğŸ“… ${getRegionName(currentRegion)} ì§€ì—­ì—<br>í•´ë‹¹ ê¸°ê°„ ê³µì—°ì´ ì—†ìŠµë‹ˆë‹¤.`);
                } else {
                    displayPerformances(allPerformances);
                }
                
            } catch (error) {
                console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                
                // ì„œë²„ê°€ ì•ˆ ì¼œì ¸ìˆì„ ë•Œ
                if (error.message.includes('Failed to fetch')) {
                    showEmptyState('âš ï¸ ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br><br>í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:<br><code>cd server && npm start</code>');
                } else {
                    showEmptyState(`âš ï¸ ${error.message}<br><br>API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.`);
                }
            }
        }

        // ê³µì—° í‘œì‹œ
        function displayPerformances(performances) {
            const list = document.getElementById('performanceList');
            
            if (performances.length === 0) {
                showEmptyState('ğŸ­ í•´ë‹¹í•˜ëŠ” ê³µì—°ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            list.innerHTML = performances.map(perf => `
                <div class="performance-item" onclick="showDetail('${perf.mt20id}')">
                    <div class="poster">
                        <img src="${perf.poster}" alt="${perf.prfnm}" onerror="this.parentElement.innerHTML='<div class=\\'loading\\'>ì´ë¯¸ì§€ ì—†ìŒ</div>'">
                    </div>
                    <div class="info">
                        <span class="genre-badge">${perf.genrenm}</span>
                        <div class="title">${perf.prfnm}</div>
                        <div class="period">ğŸ“… ${perf.prfpdfrom} ~ ${perf.prfpdto}</div>
                        <div class="venue">ğŸ“ ${perf.fcltynm}</div>
                        <span class="state-badge ${getStateClass(perf.prfstate)}">${perf.prfstate}</span>
                    </div>
                </div>
            `).join('');
        }

        // ìƒíƒœ í´ë˜ìŠ¤
        function getStateClass(state) {
            if (state === 'ê³µì—°ì™„ë£Œ') return 'ended';
            if (state === 'ê³µì—°ì˜ˆì •') return 'upcoming';
            return '';
        }

        // ì¥ë¥´ í•„í„°
        function filterByGenre(genre) {
            currentGenre = genre;
            
            // íƒ­ í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // í•„í„°ë§
            let filtered = allPerformances;
            if (genre !== 'all') {
                filtered = allPerformances.filter(perf => {
                    const genreMap = {
                        'AAAA': 'ì—°ê·¹',
                        'GGGA': 'ë®¤ì§€ì»¬',
                        'CCCA': 'ëŒ€ì¤‘ìŒì•…', // KOPISì—ì„œëŠ” 'ëŒ€ì¤‘ìŒì•…'
                        'EEEB': 'ì„œì–‘ìŒì•…(í´ë˜ì‹)',
                    };
                    // ì¥ë¥´ëª…ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ (ìœ ì—°í•œ ë§¤ì¹­)
                    const targetGenre = genreMap[genre];
                    return perf.genrenm && perf.genrenm.includes(targetGenre);
                });
            }

            if (filtered.length === 0) {
                showEmptyState('ğŸ­ í•´ë‹¹ ì¥ë¥´ì˜ ê³µì—°ì´ ì—†ìŠµë‹ˆë‹¤.');
            } else {
                displayPerformances(filtered);
            }
        }

        // ê²€ìƒ‰
        function searchPerformances() {
            const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!keyword) {
                displayPerformances(allPerformances);
                return;
            }

            const filtered = allPerformances.filter(perf => 
                perf.prfnm.toLowerCase().includes(keyword) ||
                perf.fcltynm.toLowerCase().includes(keyword)
            );

            displayPerformances(filtered);
        }

        // Enter í‚¤ë¡œ ê²€ìƒ‰
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchPerformances();
                }
            });
        });

        // ìƒì„¸ ì •ë³´
        function showDetail(id) {
            window.location.href = `detail.html?id=${id}`;
        }

        // ì§€ì—­ëª… ê°€ì ¸ì˜¤ê¸° (ì „ì²´ ì´ë¦„)
        function getRegionName(code) {
            const regionMap = {
                '11': 'ì„œìš¸', '26': 'ë¶€ì‚°', '27': 'ëŒ€êµ¬', '28': 'ì¸ì²œ',
                '29': 'ê´‘ì£¼', '30': 'ëŒ€ì „', '31': 'ìš¸ì‚°', '36': 'ì„¸ì¢…',
                '41': 'ê²½ê¸°', '42': 'ê°•ì›', '43': 'ì¶©ë¶', '44': 'ì¶©ë‚¨',
                '45': 'ì „ë¶', '46': 'ì „ë‚¨', '47': 'ê²½ë¶', '48': 'ê²½ë‚¨', '50': 'ì œì£¼'
            };
            return regionMap[code] || 'ì„œìš¸';
        }

        // ì§€ì—­ëª… ë§¤ì¹­ (API ì‘ë‹µì˜ areaì™€ ì„ íƒí•œ ì§€ì—­ ë¹„êµ)
        function matchRegion(apiArea, selectedCode) {
            if (!apiArea) return false;
            
            const regionMap = {
                '11': ['ì„œìš¸', 'ì„œìš¸íŠ¹ë³„ì‹œ', 'ì„œìš¸ì‹œ'],
                '26': ['ë¶€ì‚°', 'ë¶€ì‚°ê´‘ì—­ì‹œ', 'ë¶€ì‚°ì‹œ'],
                '27': ['ëŒ€êµ¬', 'ëŒ€êµ¬ê´‘ì—­ì‹œ', 'ëŒ€êµ¬ì‹œ'],
                '28': ['ì¸ì²œ', 'ì¸ì²œê´‘ì—­ì‹œ', 'ì¸ì²œì‹œ'],
                '29': ['ê´‘ì£¼', 'ê´‘ì£¼ê´‘ì—­ì‹œ', 'ê´‘ì£¼ì‹œ'],
                '30': ['ëŒ€ì „', 'ëŒ€ì „ê´‘ì—­ì‹œ', 'ëŒ€ì „ì‹œ'],
                '31': ['ìš¸ì‚°', 'ìš¸ì‚°ê´‘ì—­ì‹œ', 'ìš¸ì‚°ì‹œ'],
                '36': ['ì„¸ì¢…', 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ', 'ì„¸ì¢…ì‹œ'],
                '41': ['ê²½ê¸°', 'ê²½ê¸°ë„'],
                '42': ['ê°•ì›', 'ê°•ì›ë„', 'ê°•ì›íŠ¹ë³„ìì¹˜ë„'],
                '43': ['ì¶©ë¶', 'ì¶©ì²­ë¶ë„', 'ì¶©ë¶ë„'],
                '44': ['ì¶©ë‚¨', 'ì¶©ì²­ë‚¨ë„', 'ì¶©ë‚¨ë„'],
                '45': ['ì „ë¶', 'ì „ë¼ë¶ë„', 'ì „ë¶ë„', 'ì „ë¶íŠ¹ë³„ìì¹˜ë„'],
                '46': ['ì „ë‚¨', 'ì „ë¼ë‚¨ë„', 'ì „ë‚¨ë„'],
                '47': ['ê²½ë¶', 'ê²½ìƒë¶ë„', 'ê²½ë¶ë„'],
                '48': ['ê²½ë‚¨', 'ê²½ìƒë‚¨ë„', 'ê²½ë‚¨ë„'],
                '50': ['ì œì£¼', 'ì œì£¼íŠ¹ë³„ìì¹˜ë„', 'ì œì£¼ë„']
            };
            
            const regionNames = regionMap[selectedCode] || [];
            
            // apiAreaì— ì§€ì—­ëª…ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            return regionNames.some(name => apiArea.includes(name));
        }

        // ì§€ì—­ ë³€ê²½
        function changeRegion() {
            const select = document.getElementById('regionSelect');
            currentRegion = select.value;
            
            console.log('ì§€ì—­ ë³€ê²½:', getRegionName(currentRegion));
            
            // íƒ­ ì´ˆê¸°í™” (ì „ì²´ë¡œ)
            currentGenre = 'all';
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab')[0].classList.add('active');
            
            // ê³µì—° ì •ë³´ ë‹¤ì‹œ ë¡œë“œ
            loadPerformances();
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading() {
            document.getElementById('performanceList').innerHTML = `
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <div>ê³µì—° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            `;
        }

        // ë¹ˆ ìƒíƒœ
        function showEmptyState(message) {
            document.getElementById('performanceList').innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ­</div>
                    <div style="line-height: 1.6;">${message}</div>
                </div>
            `;
        }

        // ë‚ ì§œ í¬ë§·
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                sessionStorage.removeItem('isLoggedIn');
                sessionStorage.removeItem('username');
                window.location.href = 'index.html';
            }
        }

        // ì´ˆê¸°í™”
        checkLogin();
        loadPerformances();
    </script>
</body>
</html>
